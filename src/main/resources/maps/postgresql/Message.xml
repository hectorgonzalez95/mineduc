<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="cl.mineduc.induccion.mappers.MessageMapper">

	<resultMap type="cl.mineduc.induccion.modelo.WorkerMessage"
		id="workerMessage">
		<id property="id" column="id" />
		<result property="message" column="message" />
	</resultMap>

	<resultMap type="cl.mineduc.induccion.modelo.Alumno" id="alumnoMap">
		<result property="nombre" column="alumno_nombre" />
		<result property="fecha" column="alumno_fecha_nacimiento" />
		<result property="id" column="alumno_id" />
	</resultMap>

	<sql id="messagesSQL">
		SELECT message_id, message
		FROM
		ejemplo_archetype.worker_messages
	</sql>

	<sql id="obtenerAlumno">
		SELECT
		alumno_nombre,alumno_fecha_nacimiento,alumno_id
		FROM
		induccion.alumno
	</sql>

	<select id="getMessage" resultMap="workerMessage" parameterType="java.lang.Integer">
		<include refid="messagesSQL" />
		WHERE message_id = #{value}
	</select>

	<insert id="insertMessage" parameterType="cl.mineduc.induccion.modelo.WorkerMessage">
		<selectKey keyProperty="id" resultType="java.lang.Integer"
			order="BEFORE">
			SELECT nextval('ejemplo_archetype.entidades_seq')
		</selectKey>
		INSERT INTO ejemplo_archetype.worker_messages(message_id, message)
		VALUES (#{id}, #{message.message});
	</insert>

	<insert id="insertarAlumno" parameterType="cl.mineduc.induccion.modelo.Alumno">
		INSERT INTO
		induccion.alumno(alumno_id, alumno_nombre,
		alumno_fecha_nacimiento)
		VALUES(#{id}, #{nombre}, #{fecha})
	</insert>

	<select id="obtenerAlumnos" resultMap="alumnoMap">
		<include refid="obtenerAlumno" />
	</select>

	<select id="obtenerAlumno" resultMap="alumnoMap">
		<include refid="obtenerAlumno" />
		where alumno_id = #{id}
	</select>

	<delete id="eliminarAlumno" parameterType="java.lang.Integer">
		delete from induccion.alumno where alumno_id = #{id}
	</delete>

	<update id="actualizarAlumno" parameterType="cl.mineduc.induccion.modelo.Alumno">
		update induccion.alumno set
			alumno_id = #{id},
			alumno_nombre = #{nombre},
			alumno_fecha_nacimiento = #{fecha}		
		where alumno_id = #{id}
	</update>
	
	
<!-- 	=======================Cursos========================= -->
	
	
<!-- 	<resultMap type="cl.mineduc.induccion.modelo.Curso" id="cursoMap"> -->
<!-- 		<result property="nombre" column="curso_nombre" />		 -->
<!-- 		<result property="id" column="curso_id" /> -->
<!-- 	</resultMap> -->

	
<!-- 	<sql id="obtenerCurso"> -->
<!-- 		SELECT -->
<!-- 		curso_nombre,curso_id -->
<!-- 		FROM -->
<!-- 		induccion.curso -->
<!-- 	</sql> -->

	<insert id="insertarCurso" parameterType="cl.mineduc.induccion.modelo.Curso">
		INSERT INTO
		induccion.curso(curso_id, curso_nombre)	
		VALUES(#{id}, #{nombre})
	</insert>

<!-- 	<select id="obtenerCurso" resultMap="cursoMap"> -->
<!-- 		<include refid="obtenerCurso" /> -->
<!-- 	</select> -->

<!-- 	<select id="obtenerCurso" resultMap="cursoMap"> -->
<!-- 		<include refid="obtenerCurso" /> -->
<!-- 		where curso_id = #{id} -->
<!-- 	</select> -->

<!-- 	<delete id="eliminarCurso" parameterType="java.lang.Integer"> -->
<!-- 		delete from induccion.curso where curso_id = #{id} -->
<!-- 	</delete> -->

<!-- 	<update id="actualizarCurso" parameterType="cl.mineduc.induccion.modelo.Curso"> -->
<!-- 		update induccion.curso set -->
<!-- 			curso_id = #{id}, -->
<!-- 			curso_nombre = #{nombre}				 -->
<!-- 		where curso_id = #{id} -->
<!-- 	</update> -->

</mapper>

